<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PlanProof ‚Äî Motivational Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="dashboard">
    <!-- Left Column: Context Input (40%) -->
    <aside class="input-panel">
      <header class="panel-header">
        <h1 class="logo">PlanProof</h1>
        <p class="tagline">Your plan, mathematically verified.</p>
      </header>
      
      <div class="input-group">
        <label for="context-input" class="input-label">Context Dump</label>
        <textarea 
          id="context-input" 
          class="context-textarea" 
          placeholder="Paste your daily notes, tasks, constraints, and deadlines here..."
        ></textarea>
      </div>
      
      <div class="input-row">
        <div class="input-group input-group--half">
          <label for="current-time" class="input-label">Current Time</label>
          <input type="datetime-local" id="current-time" class="input-field">
        </div>
        <div class="input-group input-group--half">
          <label for="timezone" class="input-label">Timezone</label>
          <select id="timezone" class="input-field">
            <option value="America/New_York">America/New_York</option>
            <option value="America/Los_Angeles">America/Los_Angeles</option>
            <option value="Europe/London">Europe/London</option>
            <option value="Europe/Bucharest">Europe/Bucharest</option>
            <option value="Asia/Tokyo">Asia/Tokyo</option>
            <option value="UTC">UTC</option>
          </select>
        </div>
      </div>
      
      <div class="input-group">
        <label for="variant" class="input-label">Variant</label>
        <select id="variant" class="input-field">
          <option value="v1_naive">v1_naive</option>
          <option value="v2_structured">v2_structured</option>
          <option value="v3_agentic_repair">v3_agentic_repair</option>
        </select>
      </div>
      
      <button id="generate-btn" class="btn btn--primary">
        Generate Plan
      </button>
    </aside>

    <!-- Right Column: Output (60%) -->
    <main class="output-panel">
      <!-- Human Plan: Timeline (Left Sub-Column) -->
      <section class="timeline-panel">
        <header class="panel-header">
          <h2 class="panel-title">Your Plan</h2>
          <span id="plan-count" class="task-count">0 tasks</span>
        </header>
        
        <!-- Insights Header: Assumptions & Questions (PR 3.4 Revised) -->
        <div id="insights-header" class="insights-header insights-header--hidden">
          <!-- Assumptions Callout -->
          <div id="assumptions-section" class="insight-callout insight-callout--assumptions insight-callout--hidden">
            <div class="callout-header">
              <span class="callout-icon">üí°</span>
              <h3 class="callout-title">Our Assumptions</h3>
            </div>
            <ul id="assumptions-list" class="callout-list">
              <!-- Assumptions will be rendered here -->
            </ul>
          </div>
          
          <!-- Questions Callout -->
          <div id="questions-section" class="insight-callout insight-callout--questions insight-callout--hidden">
            <div class="callout-header">
              <span class="callout-icon">‚ùì</span>
              <h3 class="callout-title">Clarifying Questions</h3>
            </div>
            <ul id="questions-list" class="callout-list">
              <!-- Questions will be rendered here -->
            </ul>
          </div>
        </div>
        
        <div id="timeline-container" class="timeline">
          <!-- Timeline items will be rendered here by app.js -->
          <div class="timeline-empty">
            <div class="empty-illustration">
              <div class="empty-icon-ring">
                <span class="empty-icon">üìã</span>
              </div>
              <div class="empty-sparkle empty-sparkle--1">‚ú¶</div>
              <div class="empty-sparkle empty-sparkle--2">‚úß</div>
              <div class="empty-sparkle empty-sparkle--3">‚ú¶</div>
            </div>
            <h3 class="empty-title">Ready When You Are</h3>
            <p class="empty-message">Paste your context, constraints, and goals on the left.</p>
            <p class="empty-hint">We'll build a mathematically verified plan‚Äîno hallucinations, no overlaps.</p>
          </div>
          <!-- Loading State (PR 3.1) -->
          <div id="timeline-loading" class="timeline-loading">
            <div class="loading-spinner"></div>
            <p id="loading-message" class="loading-message">Applying deterministic guardrails...</p>
            <p class="loading-submessage">Verifying logical constraints</p>
          </div>
        </div>
      </section>

      <!-- Validation Proof: Sidebar (Right Sub-Column) -->
      <aside class="proof-sidebar">
        <header class="panel-header">
          <h2 class="panel-title">Validation Proof</h2>
        </header>
        
        <!-- Status Badge -->
        <div id="status-badge" class="status-badge status-badge--pending">
          <span class="status-icon">‚óØ</span>
          <span class="status-text">AWAITING PLAN</span>
        </div>
        
        <!-- Extracted Constraints (PR 2.1) -->
        <div id="constraints-section" class="constraints-section">
          <h3 class="section-title">Extracted Constraints</h3>
          <ul id="constraints-list" class="constraints-list">
            <li class="constraints-empty">No hard constraints detected.</li>
          </ul>
        </div>
        
        <!-- Pre-Flight Checklist -->
        <div class="checklist-section">
          <h3 class="section-title">
            Pre-Flight Checks
            <button type="button" class="info-tooltip" aria-label="What are Pre-Flight Checks?">
              <span class="info-icon">‚ìò</span>
              <span class="tooltip-content">Binary pass/fail gates that must ALL pass for a valid plan. Zero tolerance for constraint violations, time overlaps, or hallucinated tasks.</span>
            </button>
          </h3>
          <ul id="checklist" class="checklist">
            <li class="checklist-item checklist-item--pending">
              <span class="check-icon">‚óã</span>
              <span class="check-label">Constraint Violations</span>
              <span class="check-value mono">‚Äî</span>
            </li>
            <li class="checklist-item checklist-item--pending">
              <span class="check-icon">‚óã</span>
              <span class="check-label">Time Overlaps</span>
              <span class="check-value mono">‚Äî</span>
            </li>
            <li class="checklist-item checklist-item--pending">
              <span class="check-icon">‚óã</span>
              <span class="check-label">Hallucinations</span>
              <span class="check-value mono">‚Äî</span>
            </li>
            <li class="checklist-item checklist-item--pending">
              <span class="check-icon">‚óã</span>
              <span class="check-label">Keyword Recall</span>
              <span class="check-value mono">‚Äî</span>
            </li>
          </ul>
        </div>
        
        <!-- Metrics Grid (PR 1.4) -->
        <div class="metrics-section">
          <h3 class="section-title">
            Validation Metrics
            <button type="button" class="info-tooltip" aria-label="What are Validation Metrics?">
              <span class="info-icon">‚ìò</span>
              <span class="tooltip-content">Quantitative measurements from deterministic Python validators. These numbers are computed, not guessed‚Äîan LLM never grades its own plan.</span>
            </button>
          </h3>
          <div id="metrics-grid" class="metrics-grid">
            <div class="metric-tile" data-metric="constraint_violation_count">
              <span class="metric-value mono">‚Äî</span>
              <span class="metric-label">Constraint Violations</span>
            </div>
            <div class="metric-tile" data-metric="overlap_minutes">
              <span class="metric-value mono">‚Äî</span>
              <span class="metric-label">Overlap (min)</span>
            </div>
            <div class="metric-tile" data-metric="hallucination_count">
              <span class="metric-value mono">‚Äî</span>
              <span class="metric-label">Hallucinations</span>
            </div>
            <div class="metric-tile" data-metric="keyword_recall_score">
              <span class="metric-value mono">‚Äî</span>
              <span class="metric-label">Keyword Recall</span>
            </div>
          </div>
        </div>
        
        <!-- Context Coverage Progress Bar (PR 2.2) -->
        <div class="coverage-section">
          <h3 class="section-title">Context Coverage</h3>
          <div id="coverage-widget" class="coverage-widget">
            <div class="coverage-header">
              <span id="coverage-label" class="coverage-label">Calculating...</span>
              <span id="coverage-value" class="coverage-value mono">‚Äî</span>
            </div>
            <div class="coverage-bar-container">
              <div id="coverage-bar" class="coverage-bar" style="width: 0%"></div>
              <div class="coverage-threshold" title="Pass Threshold: 70%"></div>
            </div>
          </div>
        </div>
        
        <!-- Repair Attempt Log (PR 2.3) -->
        <div id="repair-section" class="repair-section repair-section--hidden">
          <div class="repair-log">
            <div class="repair-header">
              <span class="repair-icon">üîß</span>
              <span class="repair-title">Agentic Repair</span>
            </div>
            <p id="repair-message" class="repair-message">
              System attempted self-correction: <span id="repair-status" class="repair-status">‚Äî</span>
            </p>
          </div>
        </div>
        
        <!-- Errors Section -->
        <div id="errors-section" class="errors-section errors-section--hidden">
          <h3 class="section-title section-title--error">Errors</h3>
          <ul id="errors-list" class="errors-list">
            <!-- Errors will be rendered here -->
          </ul>
        </div>
        
        <!-- Opik Trace Link (PR 4.1) -->
        <div id="trace-section" class="trace-section">
          <a 
            id="trace-link" 
            href="https://www.comet.com/opik/planproof" 
            target="_blank" 
            rel="noopener noreferrer"
            class="btn-trace btn-trace--disabled"
            title="Generate a plan first to view the technical trace."
            aria-disabled="true"
          >
            <span class="trace-icon">üîç</span>
            <span class="trace-text">View Technical Trace</span>
            <span class="trace-external">‚Üó</span>
          </a>
        </div>
      </aside>
    </main>
  </div>

  <script src="app.js"></script>
</body>
</html>
